<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>hcash: hsrcore::net::ChainServer Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="HSR.ico"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">hcash
   &#160;<span id="projectnumber">2.0.0</span>
   </div>
   <div id="projectbrief">hcash</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',false,false,'search.php','Search');
});
</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacehsrcore.html">hsrcore</a></li><li class="navelem"><a class="el" href="namespacehsrcore_1_1net.html">net</a></li><li class="navelem"><a class="el" href="classhsrcore_1_1net_1_1_chain_server.html">ChainServer</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classhsrcore_1_1net_1_1_chain_server-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">hsrcore::net::ChainServer Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>The chain_server class listens for remote chain_downloaders and sends them blocks when they connect.  
 <a href="classhsrcore_1_1net_1_1_chain_server.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="_chain_server_8hpp_source.html">ChainServer.hpp</a>&gt;</code></p>
<div class="dynheader">
Collaboration diagram for hsrcore::net::ChainServer:</div>
<div class="dyncontent">
<div class="center"><img src="classhsrcore_1_1net_1_1_chain_server__coll__graph.gif" border="0" usemap="#hsrcore_1_1net_1_1_chain_server_coll__map" alt="Collaboration graph"/></div>
<map name="hsrcore_1_1net_1_1_chain_server_coll__map" id="hsrcore_1_1net_1_1_chain_server_coll__map">
</map>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a1ee0e866a542ea91d71f1ecc82c1be33"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classhsrcore_1_1net_1_1_chain_server.html#a1ee0e866a542ea91d71f1ecc82c1be33">ChainServer</a> (std::shared_ptr&lt; <a class="el" href="classhsrcore_1_1blockchain_1_1_chain_database.html">blockchain::ChainDatabase</a> &gt; chain_ptr, uint16_t port=0)</td></tr>
<tr class="memdesc:a1ee0e866a542ea91d71f1ecc82c1be33"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructs a chain_server and begins listening on the specified port.  <a href="#a1ee0e866a542ea91d71f1ecc82c1be33">More...</a><br /></td></tr>
<tr class="separator:a1ee0e866a542ea91d71f1ecc82c1be33"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac3345cfe9ffa205489531a2af0fa0db1"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classhsrcore_1_1net_1_1_chain_server.html#ac3345cfe9ffa205489531a2af0fa0db1">~ChainServer</a> ()</td></tr>
<tr class="separator:ac3345cfe9ffa205489531a2af0fa0db1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86b389735a2992413fbc4ef428ba9df2"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classhsrcore_1_1net_1_1_chain_server.html#a86b389735a2992413fbc4ef428ba9df2">get_listening_port</a> ()</td></tr>
<tr class="separator:a86b389735a2992413fbc4ef428ba9df2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>The chain_server class listens for remote chain_downloaders and sends them blocks when they connect. </p>
<p>The chain_server will bind a port and listen on it when it is constructed. If a port is specified, the server will attempt to bind that one; otherwise, the server will allow the OS to select a port. This port may be queried using the get_listening_port method.</p>
<p>The chain_server responds to chain_server_commands. When a client connects, the server first sends it the protocol version this server expects. If the client does not understand that version, it must send a finish command and terminate the connection. Otherwise, the client should send a command along with any arguments that command requires, complete the communication for that command, then repeat with another command and so-on. When the client is finished, it should send the finish command, to indicate that it is ready to terminate the connection.</p>
<p>The commands are as follows:</p><ul>
<li>get_blocks_from_number This command takes one argument, the number of the first block to retrieve. The server responds with a uint32_t count of blocks it will send, followed by the blocks, which are encoded as packed variants of full_block objects. When the server has finished sending these blocks, it repeats the procedure for any new blocks which have been made in the interim, so another count is sent, followed by that number of blocks. When the server sends a count of 0, there are no blocks, and the command is complete.</li>
</ul>
<p>All block numbers are of type uint32_t </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a1ee0e866a542ea91d71f1ecc82c1be33"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1ee0e866a542ea91d71f1ecc82c1be33">&#9670;&nbsp;</a></span>ChainServer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">hsrcore::net::ChainServer::ChainServer </td>
          <td>(</td>
          <td class="paramtype">std::shared_ptr&lt; <a class="el" href="classhsrcore_1_1blockchain_1_1_chain_database.html">blockchain::ChainDatabase</a> &gt;&#160;</td>
          <td class="paramname"><em>chain_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>port</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructs a chain_server and begins listening on the specified port. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">port</td><td>The port to listen on. If 0, the port is chosen by the OS. </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">fc::exception</td><td>If unable to bind port </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ac3345cfe9ffa205489531a2af0fa0db1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac3345cfe9ffa205489531a2af0fa0db1">&#9670;&nbsp;</a></span>~ChainServer()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">hsrcore::net::ChainServer::~ChainServer </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a86b389735a2992413fbc4ef428ba9df2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a86b389735a2992413fbc4ef428ba9df2">&#9670;&nbsp;</a></span>get_listening_port()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t hsrcore::net::ChainServer::get_listening_port </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>The port this chain_server is listening on </dd></dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>F:/hshare_org/Hcash/libraries/include/net/<a class="el" href="_chain_server_8hpp_source.html">ChainServer.hpp</a></li>
<li>F:/hshare_org/Hcash/libraries/net/<a class="el" href="_chain_server_8cpp.html">ChainServer.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
